(window.webpackJsonp=window.webpackJsonp||[]).push([[179],{644:function(e,t,r){"use strict";r.r(t);var a=r(1),i=Object(a.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"record-creation-rules"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#record-creation-rules"}},[e._v("#")]),e._v(" Record Creation Rules")]),e._v(" "),r("p",[e._v("Record Creation rules allow you to define custom rules for listening to CRUD operations on records and automatically creating new records in response to those operations.\nThese rules are defined via Dataverse records themselves, making them easy to manage and modify without needing to change any code.")]),e._v(" "),r("h2",{attrs:{id:"entities"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#entities"}},[e._v("#")]),e._v(" Entities")]),e._v(" "),r("h3",{attrs:{id:"record-creation-rule"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#record-creation-rule"}},[e._v("#")]),e._v(" Record Creation Rule")]),e._v(" "),r("p",[e._v("Record creation rules is the main entity for defining rules.")]),e._v(" "),r("p",[e._v("Looking at its form, we can see multiple sections:")]),e._v(" "),r("h4",{attrs:{id:"source-entity"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#source-entity"}},[e._v("#")]),e._v(" Source entity")]),e._v(" "),r("ul",[r("li",[e._v("Source Entity Name: Logical name of the entity to listen to")]),e._v(" "),r("li",[e._v("Trigger Messages: A multiselect optionset for selecting which CRUD operations to listen to. We can select Create, Update, Delete or Assign.")]),e._v(" "),r("li",[e._v("Filtering Attributes: A comma-separated list of attributes to filter on. This is only applicable when the Trigger Message is set to Update. If this is left empty, the rule will trigger on any update.")]),e._v(" "),r("li",[e._v("Query: After saving of the record, a query builder will become available. This allows you to define additional filtering criteria for the rule.")])]),e._v(" "),r("h4",{attrs:{id:"target-entity"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#target-entity"}},[e._v("#")]),e._v(" Target entity")]),e._v(" "),r("ul",[r("li",[e._v("Entity Name: Logical name of the entity to create records in")]),e._v(" "),r("li",[e._v("Liquid Map: A liquid template for mapping attributes from the source entity to the target entity. The source entity is used as the data input, so all of its attributes can be accessed directly. There are also some custom Dataverse tags available, see "),r("RouterLink",{attrs:{to:"/en/developer-guide/applications/utilities/liquid.html"}},[e._v("Liquid")]),e._v(" for more information.")],1)]),e._v(" "),r("h4",{attrs:{id:"update-source-record-after-action"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#update-source-record-after-action"}},[e._v("#")]),e._v(" Update Source Record (After Action)")]),e._v(" "),r("ul",[r("li",[e._v("Success: A liquid template for updating the source record after the target record has been successfully created. Can be used to change status, set a lookup to the created record, etc.")])]),e._v(" "),r("h2",{attrs:{id:"record-creation-rule-log"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#record-creation-rule-log"}},[e._v("#")]),e._v(" Record Creation Rule Log")]),e._v(" "),r("p",[e._v("In case of an error during the execution of a record creation rule, a log record will be created. In case of an error, the execution of the message is not halted and the operation will succeed, but the error will be logged for later review.")]),e._v(" "),r("h2",{attrs:{id:"how-it-works"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#how-it-works"}},[e._v("#")]),e._v(" How it works")]),e._v(" "),r("p",[e._v("In the background, there are multiple components working together to make this functionality work.")]),e._v(" "),r("p",[r("strong",[e._v("On create of a new record creation rule, we:")])]),e._v(" "),r("ul",[r("li",[e._v("Check if a record creation rule listener is already registered for the given source entity and for the selected message. If not, we register a new listener.")])]),e._v(" "),r("p",[r("strong",[e._v("On delete of a record creation rule, we:")])]),e._v(" "),r("ul",[r("li",[e._v("Check if there are any other record creation rules for the same source entity and message. If not, we unregister the listener.")])]),e._v(" "),r("p",[r("strong",[e._v("When a message is received by the listener, we:")])]),e._v(" "),r("ul",[r("li",[e._v("Retrieve all record creation rules for the given entity and message")]),e._v(" "),r("li",[e._v("For each rule, check if the filtering attributes match (if defined)")]),e._v(" "),r("li",[e._v("For each rule, check if the query matches (if defined)")]),e._v(" "),r("li",[e._v("For each matching rule, create a new target record based on the liquid map")]),e._v(" "),r("li",[e._v("For each matching rule, update the source record based on the after action liquid map (if defined)")]),e._v(" "),r("li",[e._v("In case of an error during processing of a rule, create a log record")])]),e._v(" "),r("p",[e._v("The creation itself is done by using an Action")]),e._v(" "),r("h2",{attrs:{id:"implementation-details"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#implementation-details"}},[e._v("#")]),e._v(" Implementation details")]),e._v(" "),r("p",[e._v("The main components of the implementation are:")]),e._v(" "),r("h3",{attrs:{id:"workflow-activity"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#workflow-activity"}},[e._v("#")]),e._v(" Workflow activity")]),e._v(" "),r("ul",[r("li",[r("strong",[e._v("Plugin Registrator")]),e._v(": Responsible for registering the listeners. Registers a new SDK message on a processing step of the source entity.")]),e._v(" "),r("li",[r("strong",[e._v("Plugin Deletor")]),e._v(": Responsible for unregistering the listeners. Unregisters the SDK message if there are no more rules for the given entity and message.")])]),e._v(" "),r("h3",{attrs:{id:"plugin"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#plugin"}},[e._v("#")]),e._v(" Plugin")]),e._v(" "),r("ul",[r("li",[r("strong",[e._v("ProcessRecordCreationRule")]),e._v(": The main listener plugin. Listens to the messages defined in the record creation rules and processes them.")])]),e._v(" "),r("h3",{attrs:{id:"workflows"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#workflows"}},[e._v("#")]),e._v(" Workflows")]),e._v(" "),r("ul",[r("li",[r("strong",[e._v("DeleteRuleListener")]),e._v(": A workflow that is called by the plugin deletor to delete the listener.")]),e._v(" "),r("li",[r("strong",[e._v("RegisterRuleListener")]),e._v(": A workflow that is called by the plugin registrator to register the listener.")]),e._v(" "),r("li",[r("strong",[e._v("talxis_createrecordfromrule")]),e._v(": A workflow that is called by the main listener plugin to create the target record and update the source record. It uses the liquid maps defined in the rule to perform the creation and update.")])])])}),[],!1,null,null,null);t.default=i.exports}}]);