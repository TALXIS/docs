(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{673:function(s,t,e){"use strict";e.r(t);var a=e(1),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"the-set-up"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-set-up"}},[s._v("#")]),s._v(" "),e("strong",[s._v("The set up")])]),s._v(" "),e("h2",{attrs:{id:"the-goal"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-goal"}},[s._v("#")]),s._v(" The goal")]),s._v(" "),e("p",[s._v("We want to import application user automatically via pipeline, have same unique identifier on each environment and keep the process as simple as possible.")]),s._v(" "),e("h2",{attrs:{id:"the-problem"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-problem"}},[s._v("#")]),s._v(" The problem")]),s._v(" "),e("p",[s._v("We can not use data package, because when you create app user you need to provide business unit id. Microsoft does this for you when you create application users manually through "),e("a",{attrs:{href:"https://www.admin.powerplatform.microsoft.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("admin.powerplatform.microsoft.com"),e("OutboundLink")],1),s._v(". However with pipeline you have to use API, Microsoft doesnt do anything for you and the businessunitid is always different for every environment.")]),s._v(" "),e("h2",{attrs:{id:"the-solution"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-solution"}},[s._v("#")]),s._v(" The solution")]),s._v(" "),e("p",[s._v("INT0014-Platform was expanded by a function which finds a business unit to be used and creates the app user with found business unit. You can call this function via")]),s._v(" "),e("div",{staticClass:"language-C# line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("DataImport.CreateAppUser(crmServiceClient, AppUser data)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("crmServiceClient is a client to connect to.")]),s._v(" "),e("li",[s._v("AppUser is a simple class of two guid parameters which you need to provide.")])]),s._v(" "),e("div",{staticClass:"language-C# line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("public class AppUser\n        {\n            public Guid applicationid;\n            public Guid systemuserid;\n        }\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h2",{attrs:{id:"the-sample-use-in-project"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#the-sample-use-in-project"}},[s._v("#")]),s._v(" The sample use in project")]),s._v(" "),e("p",[s._v("The guids for app users can be stored in JSON file, named Setting.json in our case.")]),s._v(" "),e("div",{staticClass:"language-JSON line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"Data"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"AppUsers"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//App User 1")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"systemuserid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0060dea9-5ea1-4295-af02-4d8639827980"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"applicationid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"af5bc2bd-f2cb-4ac2-b7bf-18b7a8d261e7"')]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//App User 2")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"systemuserid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"d3a8c139-f01a-47d7-ad6f-b9a17c2be85b"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"applicationid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6c7fe6d1-7f3b-4c0c-98fb-374d0043e7b2"')]),s._v("\n         "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n   "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("In the code you then need to read the file, parse it and call CreateAppUser, eg.")]),s._v(" "),e("div",{staticClass:"language-C# line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('private string _pathToSettingsJson\n    {\n      get\n      {\n        return string.Format("{0}\\\\{1}\\\\settings.json", Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location), GetImportPackageDataFolderName);\n      }\n    }\n\n    private JObject _settings;\n\n    public JObject Settings\n    {\n      get\n      {\n        if (_settings == null || _settings == default(JObject))\n        {\n          _settings = JObject.Parse(File.ReadAllText(_pathToSettingsJson));\n        }\n\n        return _settings;\n      }\n    }\n\nprivate void CreateAppUsers()\n    {\n      JArray AppUsers = (JArray)Settings["Data"]["AppUsers"];\n      AppUsers.ToList().ForEach(\n          x =>\n          {\n            var data = new DataImport.AppUser()\n            {\n              applicationid = new Guid((string)x["applicationid"]),\n              systemuserid = new Guid((string)x["systemuserid"])\n            };\n            DataImport.CreateAppUser(CrmSvc, data);\n          });\n    }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br")])]),e("h2",{attrs:{id:"limitations"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#limitations"}},[s._v("#")]),s._v(" Limitations")]),s._v(" "),e("p",[s._v("Currently, the process was developed for use with TALXIS Portal solutions, where business unit entity is not used. Thus there is always just one unit, generated by Microsoft. If your project uses multiple business units, the implementation might need to be changed so that the function adds the app user under correct business unit. Suggested solution would be to order business units by 'CreatedOn' and get the oldest.")]),s._v(" "),e("h2",{attrs:{id:"suggested-improvements"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#suggested-improvements"}},[s._v("#")]),s._v(" Suggested improvements")]),s._v(" "),e("p",[s._v("The CreateAppUser function could be customized so that systemuserid is optional parameter.")])])}),[],!1,null,null,null);t.default=n.exports}}]);