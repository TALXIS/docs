(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{505:function(e,t,n){"use strict";n.r(t);var a=n(1),r=function(e){e.options.__data__block__={mermaid_1a96284d:"%%{init: {'theme': 'dark'}}%%\nsequenceDiagram\n    participant U as User\n    participant FE as File Explorer PCF\n    participant AAD as AAD (Azure Active Directory)\n    participant AZ as Azure (TALXIS STS)\n    participant MG as Microsoft Graph Api\n    participant SP as SharePoint\n\n    U ->> FE: Interaction in app\n\n    FE ->> AAD: Silent SSO or Pop-Up\n    activate AAD\n    AAD --\x3e> FE: Return token\n    deactivate AAD\n\n    FE ->> FE: Use returned token\n\n    FE ->> AZ: Call using<br>On-Behalf-Of Flow\n    activate AZ\n    AZ ->> AZ: \n    Note over AZ: TALXIS Security Tokens Service\n    AZ --\x3e> FE: Return token\n    deactivate AZ\n\n    FE ->> FE: Use returned token\n\n    FE ->> MG: Authenticated request\n    activate MG\n    MG ->> SP: File read/File write\n    activate SP\n    SP --\x3e> MG: Result\n    deactivate SP\n    MG --\x3e> FE: Result\n    deactivate MG\n\n    FE ->> U: Response\n"}},i=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"authentication-diagram-of-file-explorer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#authentication-diagram-of-file-explorer"}},[e._v("#")]),e._v(" Authentication diagram of File Explorer")]),e._v(" "),n("Mermaid",{attrs:{id:"mermaid_1a96284d",graph:e.$dataBlock.mermaid_1a96284d}}),n("p",[e._v("File Explorer PCF (PowerApps Component Framework) control enables secure file interactions with SharePoint via Microsoft Graph API.\nFor more information about neccessary app consents, please refer to "),n("RouterLink",{attrs:{to:"/docs/src/en/customizer-guide/required-application-consent.html#talxis---pcffilepicker"}},[e._v("this page")]),e._v(".")],1),e._v(" "),n("h2",{attrs:{id:"security-tokens-service"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#security-tokens-service"}},[e._v("#")]),e._v(" Security tokens service")]),e._v(" "),n("p",[e._v("After a successful authentication with the consented Azure app, the token is exchanged with securitytokens.services.talxis.com, a custom atuhentication service, which exchanges the App token for a MS Graph token with desired scopes. This is done using "),n("a",{attrs:{href:"https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-on-behalf-of-flow",target:"_blank",rel:"noopener noreferrer"}},[e._v("On-Behalf-Of-Flow pattern"),n("OutboundLink")],1)]),e._v(" "),n("p",[e._v("The Security Tokens Service (STS) is a custom service that acts as an intermediary between the File Explorer control and Microsoft Graph API. It takes the token received from Azure Active Directory (AAD) after user authentication and exchanges it for a token that has the necessary permissions to access SharePoint resources. The service itself does not store any user data or credentials; it simply facilitates the token exchange process. The biggest benefit of this approach is that we don't require the user to log in again, minimizing the need for multiple pop-ups and improving the user experience.")]),e._v(" "),n("p",[e._v("That token is then used to access SharePoint resources via Microsoft Graph API, allowing the control to perform file operations such as upload, download, and delete.")]),e._v(" "),n("p",[e._v("For more information, please refer to the "),n("a",{attrs:{href:"https://dev.azure.com/thenetworg/INT0015/_wiki/wikis/INT0015.wiki/4301/Authentication-Flow",target:"_blank",rel:"noopener noreferrer"}},[e._v("internal documentation"),n("OutboundLink")],1)])],1)}),[],!1,null,null,null);"function"==typeof r&&r(i);t.default=i.exports}}]);